<!DOCTYPE html>
<html>
  <head>
    <title>Socket.IO Example</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js"></script>
  </head>
  <body>
    <form id="locationForm">
      <label for="latitude">위도:</label><br />
      <input type="text" id="latitude" name="latitude" /><br />
      <label for="longitude">경도:</label><br />
      <input type="text" id="longitude" name="longitude" /><br />
      <button id="sendButton">위치 정보 전송</button>
    </form>

    <p id="placeDisplay"></p>

    <script>
      // Socket.IO 서버에 연결
      const socket = io("http://localhost:3000");

      // 위치 정보 전송
      function sendLocation(location) {
        socket.emit("sendLocation", location);
      }

      // 예시: 버튼 클릭 시 위치 정보 전송
      document
        .getElementById("sendButton")
        .addEventListener("click", function (e) {
          e.preventDefault(); // form submit을 막음
          const latitude = document.getElementById("latitude").value;
          const longitude = document.getElementById("longitude").value;
          const location = {
            latitude: parseFloat(latitude),
            longitude: parseFloat(longitude),
          };
          sendLocation(location);
        });

      // 서버에서 유저 위치 정보 수신
      socket.on("userLocation", ({ userId, location, place }) => {
        console.log(`유저 ${userId}의 위치: ${location}, 위치 이름: ${place}`);
        // 위치 정보를 화면에 출력
        document.getElementById(
          "placeDisplay"
        ).textContent = `유저 ${userId}의 위치 이름: ${place}`;
      });

      // 서버에서 유저 연결 종료 정보 수신
      socket.on("userDisconnect", (userId) => {
        console.log(`유저 ${userId}의 연결이 종료되었습니다.`);
        // 연결 종료에 대한 처리 수행
      });
    </script>
  </body>
</html>
